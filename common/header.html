<script type="text/discourse-plugin" version="0.8">

    function parseSettings() {
        return JSON.parse(settings.setup);
    }
    var tagged = false;
    var url = "";

    api.modifyClass("component:topic-category", {
      didInsertElement: function() {
        this._super();
        const data = parseSettings();
        for (let i=0; i < this.topic.tags.length; i++){
            if(this.topic.tags.includes(data[i]["tag"])){
                console.log("we found em boys");
                tagged = true;
                url = data[i]["url"];
                break;
            } else {
                console.log("no");
            }
        }
      }
    });

  const h = require("virtual-dom").h;

  api.createWidget("custom-button-widget", {
    tagName: "div.custom-button",

    html() {
      if (tagged) {
        return h("a.custom-button", {href: url}, "MUG Homepage");
      } else {
        return h('div', " ");
      }
      
    }
  });

</script>


<script type="text/x-handlebars" data-template-name="/connectors/topic-category/foobar2">
    {{mount-widget widget="custom-button-widget"}}
</script>